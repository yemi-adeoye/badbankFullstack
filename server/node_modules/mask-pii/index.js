
const PIIProperties = [
  'token',
  'password',
  'email',
  'emailAddress',
  'firstName',
  'lastName',
  'Token',
  'tokens',
  'clientKey',
  'clientSecret',
  'code',
  'authorization',
  'message',
  'number',
  'nationalityId',
  'passportNo',
  'value',
  'accessToken',
  'tempToken',
  'secret',
];

const MaskedString = "********";

defaultMaskFunction = (key, value) => value;

const mask = (maskFn = defaultMaskFunction) => (key, value) => {
  if (PIIProperties.includes(key)) {
    return MaskedString;
  }
  return maskFn(key, value);
}

module.exports = (maskFn) => mask(maskFn);