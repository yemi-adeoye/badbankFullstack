const responser = require('../index');
const sinon = require('sinon');
const assert = require('chai').assert;
const expect = require('chai').expect;

describe("express-responser test units", () => {
	it('Success response test', (done) => {
		let data = {
			dummy: '1'
		};


		let res = {
			status: sinon.stub(),
			json: sinon.stub(),
			locals: {
				'test': 1
			}
		};

		res.status.returnsThis();

		res.status.returnsThis();
		res.json.withArgs(data).returns({data: data});

		responser.success(res, data);

		assert(res.status.called);
		assert(res.json.calledWith({data: data}));
		expect(res.locals).eql({'responseBody': data, 'test': 1});
		done();
	});


	it('Error response test', (done) => {
		let error = new Error("Dummy Error");
		let next = sinon.spy();

		responser.withError(next, error);

		assert(next.calledWith(error));
		done();
	});
});