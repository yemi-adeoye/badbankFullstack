const ip = require('ip');

module.exports = (authorizedSubnets, paramIp) => {
  let next = false;
  let parameterIp = paramIp;
  const subnets = Array.isArray(authorizedSubnets) ? authorizedSubnets : [authorizedSubnets];
  if (paramIp.includes('::ffff:')) {
    parameterIp = paramIp.substring(7);
  }

  subnets.forEach((subnet) => {
    if (subnet && ip.cidrSubnet(subnet).contains(parameterIp)) {
      next = true;
    }
  });

  return next;
};
